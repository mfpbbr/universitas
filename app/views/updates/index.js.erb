<% if params[:last].blank? %>
  $('#lists').html("<%= escape_javascript(partial('list', :collection => collection, :type => params[:type], :last => nil, :id => params[:id]))%>");
<% else %>
  <% if collection.blank? %>
  	$('#infinite-scroll').detach();
  <% else %>
    element = $('.updates');
    if ($(element).find('.endless_scroll_inner_wrap').length){
      var div = '.endless_scroll_inner_wrap';
    }else{
      var div = element;
    }
    element.data('last', '<%=collection.to_a.last.id%>')
    $(div).append("<%= escape_javascript(render collection) %>");
  <% end %>
<% end %>